# Загрузка файлов в S3 хранилище (Yandex.Cloud) с подготовкой к уведомлениям

Данный проект - сервис загрузки файлов в S3 хранилище с дальнейшей возможностью рассылки уведомлений.

# Технологии
Java, Spring Boot, RST API, PostgreSQL, Docker, Kafka, S3 storage

## Описание функционала
Приложение состоит из нескольких частей:
- Шлюз;
- Сервис заявок + БД;
- Сервис уведомлений + БД;
- Брокер сообщений.

Запуск происходит через Docker.
Все компоненты запускаются в отдельных Docker контейнерах, их взаимодействие настроено через Docker compose.

> Запросы приходят в единую точку входа по адресу: {host}:8080/api/orders/process
> 
> далее перенаправляются на внутренний сервис обработки запросов

## ORDER_SERVICE:
### Сервис по загрузке файлов в S3 хранилище (Yandex.Cloud).
> при запросе добавления нового файла создается запись в кафке в топике order_created
> 
> при запросе обновление файла создается запись в кафке в топике order_updated
> 
> при запросе удаления файла создается запись в кафке в топике order_deleted

- ***POST /api/orders*** - метод загрузки файла.
  - ***body:*** ожидается файл для загрузки.
  - ***return:*** структура с названием файла и ссылкой на скачивание.

- ***POST /api/orders/multi*** - метод множественной загрузки файлов.
  - ***body:*** ожидается список файлов для загрузки.
  - ***return:*** список структур с названием файла и ссылкой на скачивание.

- ***PATCH /api/orders?bucket=...&key=...*** - метод обновления загруженного файла.
  - bucket из Yandex.Cloud где загружен файл;
  - папка bucket загруженного файла;
  - ***body:***
    - обновленный файл.

- ***DELETE /api/orders?bucket=...&key=...*** - метод удаления загруженного файла.
  - bucket из Yandex.Cloud где загружен файл;
  - папка bucket загруженного файла.



## NOTIFICATION SERVICE:
### Сервис уведомлений получает данные из Kafka, но так же возможно работать с API.
> при появлении новых данных в топике order_created - происходит логирование о загруженном файле.
> 
> при появлении новых данных в топике order_updated - происходит логирование об обновленном файле.
> 
> при появлении новых данных в топике order_deleted - происходит логирование об удаленном файле.

- ***GET /api/subscriptions/{id}*** - метод получения информации о загруженном файле.
  - id - уникальный номер уведомления.

- ***POST /api/subscriptions*** - метод создания нового уведомления.
  - ***body:*** ожидается ссылка на загруженный файл.
  - ***return:*** структура
    - id записи уведомления;
    - url загруженного файла;
    - статус файла (загружен, обновлен, удален);
    - время создания уведомления.

- ***PATCH /api/subscriptions/{id}*** - метод обновления уведомления.
  - id - уникальный номер уведомления;
  - ***body:*** обновленное уведомление.
  - ***return:*** структура
    - id записи уведомления;
    - url загруженного файла;
    - статус файла (загружен, обновлен, удален);
    - время создания уведомления.

- ***DELETE /api/subscriptions/{id}*** - метод удаления уведомления.
  - id - уникальный номер уведомления.

